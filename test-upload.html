<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Image Upload - Drisya AI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            background: #fafafa;
        }
        .upload-area:hover {
            border-color: #007bff;
            background: #f0f8ff;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .preview {
            max-width: 300px;
            margin: 20px auto;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Drisya AI - Test Image Enhancement</h1>
        <p>Upload your earrings image to test the AI enhancement with your custom velvet background prompt.</p>
        
        <div class="upload-area" onclick="document.getElementById('fileInput').click()">
            <h3>üì∏ Click to Upload Earrings Image</h3>
            <p>Select the golden spiral earrings image</p>
            <input type="file" id="fileInput" accept="image/*" style="display: none;">
        </div>
        
        <div id="preview"></div>
        
        <button class="btn" onclick="processImage()" id="processBtn" disabled>
            üöÄ Enhance with AI
        </button>
        
        <div id="result"></div>
        
        <div style="margin-top: 30px; padding: 20px; background: #e9ecef; border-radius: 5px;">
            <h3>üìù AI Enhancement Prompt:</h3>
            <p style="font-style: italic; color: #666;">
                "A dark, elegant matte blue velvet or suede background with soft texture, under moody, directional lighting. Strong light beams cast realistic shadows in a criss-cross windowpane pattern, creating a dramatic and luxurious ambiance. The scene should evoke a sense of evening or indoor light streaming through a window, with a focused spotlight on the product area and soft shadows to highlight depth and contrast. The environment should feel premium, rich, and cinematic. Ensure the earrings design, link pattern, clasp details, colors, and background elements remain exactly the same with no changes or alterations to composition, color, or lighting."
            </p>
        </div>
    </div>

    <script>
        let selectedFile = null;

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                selectedFile = file;
                
                // Show preview
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('preview').innerHTML = 
                        `<img src="${e.target.result}" class="preview" alt="Preview">
                         <p><strong>File:</strong> ${file.name}</p>
                         <p><strong>Size:</strong> ${(file.size / 1024).toFixed(1)} KB</p>`;
                };
                reader.readAsDataURL(file);
                
                document.getElementById('processBtn').disabled = false;
            }
        });

        async function processImage() {
            if (!selectedFile) {
                alert('Please select an image first!');
                return;
            }

            const resultDiv = document.getElementById('result');
            const processBtn = document.getElementById('processBtn');
            
            processBtn.disabled = true;
            processBtn.textContent = '‚è≥ Processing...';
            
            try {
                const formData = new FormData();
                formData.append('image', selectedFile);
                formData.append('prompt', `A dark, elegant matte blue velvet or suede background with soft texture, under moody, directional lighting. Strong light beams cast realistic shadows in a criss-cross windowpane pattern, creating a dramatic and luxurious ambiance. The scene should evoke a sense of evening or indoor light streaming through a window, with a focused spotlight on the product area and soft shadows to highlight depth and contrast. The environment should feel premium, rich, and cinematic. Ensure the earrings design, link pattern, clasp details, colors, and background elements remain exactly the same with no changes or alterations to composition, color, or lighting.`);

                const response = await fetch('/api/test-enhancement', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (response.ok && result.success) {
                    resultDiv.innerHTML = `
                        <div class="result success">
                            <h3>‚úÖ Enhancement Successful!</h3>
                            <p><strong>Processing Time:</strong> ${result.processingTime}ms</p>
                            <p><strong>Enhanced Image:</strong> <a href="${result.outputUrl}" target="_blank">Download</a></p>
                            <img src="${result.outputUrl}" class="preview" alt="Enhanced Result">
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h3>‚ùå Enhancement Failed</h3>
                            <p><strong>Error:</strong> ${result.error || 'Unknown error'}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>‚ùå Request Failed</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }

            processBtn.disabled = false;
            processBtn.textContent = 'üöÄ Enhance with AI';
        }
    </script>
</body>
</html>
